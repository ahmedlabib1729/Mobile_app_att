<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Tree View for COD Ranges -->
    <record id="view_cod_fee_range_tree" model="ir.ui.view">
        <field name="name">cod.fee.range.tree</field>
        <field name="model">cod.fee.range</field>
        <field name="arch" type="xml">
            <list string="COD Fee Ranges" editable="bottom">
                <field name="amount_from"/>
                <field name="amount_to"/>
                <field name="fee_type"/>
                <!-- ðŸ†• ÙÙŠ Odoo 18 Ø§Ø³ØªØ®Ø¯Ù… invisible Ø¨Ø¯Ù„ column_invisible -->
                <field name="cash_percentage" invisible="fee_type == 'fixed'"/>
                <field name="visa_percentage" invisible="fee_type == 'fixed'"/>
                <field name="cash_fixed_amount" invisible="fee_type == 'percentage'"/>
                <field name="visa_fixed_amount" invisible="fee_type == 'percentage'"/>
            </list>
        </field>
    </record>

    <!-- Form View for COD Ranges -->
    <record id="view_cod_fee_range_form" model="ir.ui.view">
        <field name="name">cod.fee.range.form</field>
        <field name="model">cod.fee.range</field>
        <field name="arch" type="xml">
            <form string="COD Fee Range">
                <sheet>
                    <group>
                        <group string="Range">
                            <field name="amount_from"/>
                            <field name="amount_to" help="Use 0 for unlimited"/>
                        </group>
                        <group string="Fee Configuration">
                            <field name="fee_type" widget="radio"/>
                        </group>
                    </group>

                    <!-- ðŸ†• Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ© -->
                    <group string="Percentage Fees" invisible="fee_type == 'fixed'">
                        <group>
                            <field name="cash_percentage"/>
                            <field name="visa_percentage"/>
                        </group>
                    </group>

                    <!-- ðŸ†• Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø«Ø§Ø¨ØªØ© -->
                    <group string="Fixed Fees" invisible="fee_type == 'percentage'">
                        <group>
                            <field name="cash_fixed_amount"/>
                            <field name="visa_fixed_amount"/>
                        </group>
                    </group>

                    <div class="alert alert-info mt-3">
                        <i class="fa fa-info-circle"/>
                        <strong>Percentage:</strong> Fee = Amount Ã— Percentage / 100<br/>
                        <strong>Fixed:</strong> Fee = Fixed Amount (regardless of total)
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ØªØ¹Ø¯ÙŠÙ„ Shipping Company Form -->
    <record id="view_shipping_company_form_cod_ranges" model="ir.ui.view">
        <field name="name">shipping.company.form.cod.ranges</field>
        <field name="model">shipping.company</field>
        <field name="inherit_id" ref="shipping_management_system.view_shipping_company_form"/>
        <field name="arch" type="xml">
            <!-- Ø§Ø³ØªØ¨Ø¯Ù„ Ù…Ø­ØªÙˆÙ‰ ØµÙØ­Ø© COD Configuration -->
            <xpath expr="//page[@name='cod_config']" position="replace">
                <page string="COD Configuration" name="cod_config">
                    <group>
                        <field name="cod_include_shipping"/>
                    </group>

                    <separator string="COD Fee Ranges"/>

                    <field name="cod_fee_ranges" nolabel="1">
                        <list editable="bottom">
                            <field name="amount_from"/>
                            <field name="amount_to"/>
                            <field name="fee_type"/>
                            <!-- ðŸ†• Ø§Ø³ØªØ®Ø¯Ù… invisible -->
                            <field name="cash_percentage" invisible="fee_type == 'fixed'"/>
                            <field name="visa_percentage" invisible="fee_type == 'fixed'"/>
                            <field name="cash_fixed_amount" invisible="fee_type == 'percentage'"/>
                            <field name="visa_fixed_amount" invisible="fee_type == 'percentage'"/>
                        </list>
                    </field>

                    <div class="alert alert-info mt-3">
                        <i class="fa fa-info-circle"/>
                        <strong>Define COD fee ranges:</strong><br/>
                        â€¢ <strong>Percentage:</strong> Fee calculated as % of amount<br/>
                        â€¢ <strong>Fixed:</strong> Fixed fee regardless of amount<br/>
                        â€¢ Leave 'To' as 0 for unlimited upper limit
                    </div>
                </page>
            </xpath>
        </field>
    </record>

    <!-- ØªØ¹Ø¯ÙŠÙ„ Customer Category Form -->
    <record id="view_customer_price_category_form_cod_ranges" model="ir.ui.view">
        <field name="name">customer.price.category.form.cod.ranges</field>
        <field name="model">customer.price.category</field>
        <field name="inherit_id" ref="shipping_management_system.view_customer_price_category_form"/>
        <field name="arch" type="xml">
            <!-- Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¯Ù„ group ÙƒØ§Ù…Ù„ -->
            <xpath expr="//field[@name='company_cod_minimum_amount']/.." position="replace">
                <separator string="Company COD Fee Ranges (Your Profit)"/>

                <field name="company_cod_fee_ranges" nolabel="1">
                    <list editable="bottom">
                        <field name="amount_from"/>
                        <field name="amount_to"/>
                        <field name="fee_type"/>
                        <!-- ðŸ†• Ø§Ø³ØªØ®Ø¯Ù… invisible -->
                        <field name="cash_percentage" invisible="fee_type == 'fixed'"/>
                        <field name="visa_percentage" invisible="fee_type == 'fixed'"/>
                        <field name="cash_fixed_amount" invisible="fee_type == 'percentage'"/>
                        <field name="visa_fixed_amount" invisible="fee_type == 'percentage'"/>
                    </list>
                </field>

                <div class="alert alert-info mt-3">
                    <i class="fa fa-info-circle"/>
                    <strong>Company COD Fee Ranges (Your Profit Margin):</strong><br/>
                    â€¢ <strong>Percentage:</strong> Profit = Amount Ã— Percentage / 100<br/>
                    â€¢ <strong>Fixed:</strong> Fixed profit per shipment<br/>
                    â€¢ Leave 'To' as 0 for unlimited range
                </div>
            </xpath>
        </field>
    </record>
</odoo>