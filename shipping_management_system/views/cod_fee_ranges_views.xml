<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Tree View for COD Ranges -->
    <record id="view_cod_fee_range_tree" model="ir.ui.view">
        <field name="name">cod.fee.range.tree</field>
        <field name="model">cod.fee.range</field>
        <field name="arch" type="xml">
            <list string="COD Fee Ranges" editable="bottom">
                <field name="amount_from"/>
                <field name="amount_to"/>
                <field name="cash_percentage"/>
                <field name="visa_percentage"/>
            </list>
        </field>
    </record>

    <!-- Form View for COD Ranges -->
    <record id="view_cod_fee_range_form" model="ir.ui.view">
        <field name="name">cod.fee.range.form</field>
        <field name="model">cod.fee.range</field>
        <field name="arch" type="xml">
            <form string="COD Fee Range">
                <sheet>
                    <group>
                        <group>
                            <field name="amount_from"/>
                            <field name="amount_to" help="Use 0 for unlimited"/>
                        </group>
                        <group>
                            <field name="cash_percentage"/>
                            <field name="visa_percentage"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- تعديل Shipping Company Form -->
    <record id="view_shipping_company_form_cod_ranges" model="ir.ui.view">
        <field name="name">shipping.company.form.cod.ranges</field>
        <field name="model">shipping.company</field>
        <field name="inherit_id" ref="shipping_management_system.view_shipping_company_form"/>
        <field name="arch" type="xml">
            <!-- استبدل محتوى صفحة COD Configuration -->
            <xpath expr="//page[@name='cod_config']" position="replace">
                <page string="COD Configuration" name="cod_config">
                    <group>
                        <field name="cod_include_shipping"/>
                    </group>

                    <separator string="COD Fee Ranges"/>

                    <field name="cod_fee_ranges" nolabel="1">
                        <list editable="bottom">
                            <field name="amount_from"/>
                            <field name="amount_to"/>
                            <field name="cash_percentage"/>
                            <field name="visa_percentage"/>
                        </list>
                    </field>

                    <div class="alert alert-info mt-3">
                        <i class="fa fa-info-circle"/>
                        Define COD fee ranges based on amount. Leave 'To' as 0 for unlimited upper limit.
                    </div>
                </page>
            </xpath>
        </field>
    </record>

    <!-- تعديل Customer Category Form -->
    <record id="view_customer_price_category_form_cod_ranges" model="ir.ui.view">
        <field name="name">customer.price.category.form.cod.ranges</field>
        <field name="model">customer.price.category</field>
        <field name="inherit_id" ref="shipping_management_system.view_customer_price_category_form"/>
        <field name="arch" type="xml">
            <!-- استبدل الحقول القديمة بدل group كامل -->
            <xpath expr="//field[@name='company_cod_minimum_amount']/.." position="replace">
                <separator string="Company COD Fee Ranges"/>

                <field name="company_cod_fee_ranges" nolabel="1">
                    <list editable="bottom">
                        <field name="amount_from"/>
                        <field name="amount_to"/>
                        <field name="cash_percentage"/>
                        <field name="visa_percentage"/>
                    </list>
                </field>

                <div class="alert alert-info mt-3">
                    <i class="fa fa-info-circle"/>
                    Define COD fee ranges for this customer category. Leave 'To' as 0 for unlimited.
                </div>
            </xpath>
        </field>
    </record>
</odoo>