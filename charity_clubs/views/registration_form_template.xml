<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- فورم التسجيل -->
    <template id="registration_form" name="فورم التسجيل">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">
                <section class="s_breadcrumb pt20 pb20 bg-light">
                    <div class="container">
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0">
                                <li class="breadcrumb-item"><a href="/clubs">النوادي</a></li>
                                <li class="breadcrumb-item">
                                    <a t-att-href="'/clubs/%s' % slug(club)" t-field="club.name"/>
                                </li>
                                <li class="breadcrumb-item">
                                    <a t-att-href="'/programs/%s' % slug(program)" t-field="program.name"/>
                                </li>
                                <li class="breadcrumb-item active">التسجيل</li>
                            </ol>
                        </nav>
                    </div>
                </section>

                <section class="s_registration_form pt40 pb40">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <h1 class="text-center mb-4">تسجيل في <span t-field="program.name"/></h1>

                                <t t-if="error.get('general')">
                                    <div class="alert alert-danger">
                                        <t t-esc="error['general']"/>
                                    </div>
                                </t>

                                <form t-att-action="'/programs/%s/register/submit' % slug(program)"
                                      method="post" enctype="multipart/form-data">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <h3 class="mb-0">معلومات الطالب</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="required">اسم الطالب (كما في الهوية)</label>
                                                    <input type="text" name="student_name"
                                                           class="form-control"
                                                           t-att-value="values.get('student_name')"
                                                           required="required"/>
                                                    <t t-if="error.get('student_name')">
                                                        <span class="text-danger" t-esc="error['student_name']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">تاريخ الميلاد</label>
                                                    <input type="date" name="birth_date"
                                                           class="form-control"
                                                           t-att-value="values.get('birth_date')"
                                                           required="required"/>
                                                    <t t-if="error.get('birth_date')">
                                                        <span class="text-danger" t-esc="error['birth_date']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">الجنس</label>
                                                    <select name="gender" class="form-control" required="required">
                                                        <option value="">-- اختر --</option>
                                                        <option value="male" t-att-selected="values.get('gender') == 'male'">ذكر</option>
                                                        <option value="female" t-att-selected="values.get('gender') == 'female'">أنثى</option>
                                                    </select>
                                                    <t t-if="error.get('gender')">
                                                        <span class="text-danger" t-esc="error['gender']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label>رقم الهوية الإماراتية</label>
                                                    <input type="text" name="emirates_id"
                                                           class="form-control"
                                                           placeholder="784-YYYY-XXXXXXX-X"
                                                           t-att-value="values.get('emirates_id')"/>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">الجنسية</label>
                                                    <select name="nationality_id" class="form-control" required="required">
                                                        <option value="">-- اختر الدولة --</option>
                                                        <t t-foreach="countries" t-as="country">
                                                            <option t-att-value="country.id"
                                                                    t-att-selected="str(country.id) == values.get('nationality_id')">
                                                                <t t-esc="country.name"/>
                                                            </option>
                                                        </t>
                                                    </select>
                                                    <t t-if="error.get('nationality_id')">
                                                        <span class="text-danger" t-esc="error['nationality_id']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">اللغة الأم</label>
                                                    <select name="native_language" class="form-control" required="required">
                                                        <option value="">-- اختر --</option>
                                                        <option value="arabic" t-att-selected="values.get('native_language') == 'arabic'">العربية</option>
                                                        <option value="english" t-att-selected="values.get('native_language') == 'english'">الإنجليزية</option>
                                                        <option value="urdu" t-att-selected="values.get('native_language') == 'urdu'">الأردية</option>
                                                        <option value="hindi" t-att-selected="values.get('native_language') == 'hindi'">الهندية</option>
                                                        <option value="other" t-att-selected="values.get('native_language') == 'other'">أخرى</option>
                                                    </select>
                                                    <t t-if="error.get('native_language')">
                                                        <span class="text-danger" t-esc="error['native_language']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label>المدرسة</label>
                                                    <input type="text" name="school_name"
                                                           class="form-control"
                                                           t-att-value="values.get('school_name')"/>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label>الصف الدراسي</label>
                                                    <input type="text" name="class_level"
                                                           class="form-control"
                                                           t-att-value="values.get('class_level')"/>
                                                </div>
                                            </div>

                                            <div class="row mt-3">
                                                <div class="col-md-4 mb-3">
                                                    <label>هل حضر نادي عربي سابقاً؟</label>
                                                    <div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="attended_arabic_club" value="yes"
                                                                   t-att-checked="values.get('attended_arabic_club') == 'yes'"/>
                                                            <label class="form-check-label">نعم</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="attended_arabic_club" value="no"
                                                                   t-att-checked="values.get('attended_arabic_club', 'no') == 'no'"/>
                                                            <label class="form-check-label">لا</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-4 mb-3">
                                                    <label>هل حضر الأنشطة الصيفية سابقاً؟</label>
                                                    <div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="attended_summer_activities" value="yes"
                                                                   t-att-checked="values.get('attended_summer_activities') == 'yes'"/>
                                                            <label class="form-check-label">نعم</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="attended_summer_activities" value="no"
                                                                   t-att-checked="values.get('attended_summer_activities', 'no') == 'no'"/>
                                                            <label class="form-check-label">لا</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-4 mb-3">
                                                    <label>مهتم بحفظ القرآن؟</label>
                                                    <div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="interested_quran" value="yes"
                                                                   t-att-checked="values.get('interested_quran') == 'yes'"/>
                                                            <label class="form-check-label">نعم</label>
                                                        </div>
                                                        <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio"
                                                                   name="interested_quran" value="no"
                                                                   t-att-checked="values.get('interested_quran', 'no') == 'no'"/>
                                                            <label class="form-check-label">لا</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <h3 class="mb-0">معلومات ولي الأمر</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="required">اسم الأب</label>
                                                    <input type="text" name="father_name"
                                                           class="form-control"
                                                           t-att-value="values.get('father_name')"
                                                           required="required"/>
                                                    <t t-if="error.get('father_name')">
                                                        <span class="text-danger" t-esc="error['father_name']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">اسم الأم</label>
                                                    <input type="text" name="mother_name"
                                                           class="form-control"
                                                           t-att-value="values.get('mother_name')"
                                                           required="required"/>
                                                    <t t-if="error.get('mother_name')">
                                                        <span class="text-danger" t-esc="error['mother_name']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label class="required">رقم جوال ولي الأمر</label>
                                                    <input type="tel" name="parent_mobile"
                                                           class="form-control"
                                                           placeholder="+971501234567"
                                                           t-att-value="values.get('parent_mobile')"
                                                           required="required"/>
                                                    <t t-if="error.get('parent_mobile')">
                                                        <span class="text-danger" t-esc="error['parent_mobile']"/>
                                                    </t>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label>WhatsApp الأم</label>
                                                    <input type="tel" name="mother_whatsapp"
                                                           class="form-control"
                                                           placeholder="+971501234567"
                                                           t-att-value="values.get('mother_whatsapp')"/>
                                                </div>

                                                <div class="col-md-12 mb-3">
                                                    <label>البريد الإلكتروني</label>
                                                    <input type="email" name="parent_email"
                                                           class="form-control"
                                                           t-att-value="values.get('parent_email')"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <h3 class="mb-0">الترمات المطلوبة</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio"
                                                       name="selected_terms" value="term1"
                                                       id="term1"
                                                       t-att-checked="values.get('selected_terms') == 'term1'"/>
                                                <label class="form-check-label" for="term1">
                                                    الترم الأول فقط -
                                                    <t t-esc="program.term1_price"
                                                       t-options='{"widget": "monetary", "display_currency": program.currency_id}'/>
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio"
                                                       name="selected_terms" value="term2"
                                                       id="term2"
                                                       t-att-checked="values.get('selected_terms') == 'term2'"/>
                                                <label class="form-check-label" for="term2">
                                                    الترم الثاني فقط -
                                                    <t t-esc="program.term2_price"
                                                       t-options='{"widget": "monetary", "display_currency": program.currency_id}'/>
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio"
                                                       name="selected_terms" value="term3"
                                                       id="term3"
                                                       t-att-checked="values.get('selected_terms') == 'term3'"/>
                                                <label class="form-check-label" for="term3">
                                                    الترم الثالث فقط -
                                                    <t t-esc="program.term3_price"
                                                       t-options='{"widget": "monetary", "display_currency": program.currency_id}'/>
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio"
                                                       name="selected_terms" value="all"
                                                       id="all_terms"
                                                       t-att-checked="values.get('selected_terms', 'all') == 'all'"/>
                                                <label class="form-check-label" for="all_terms">
                                                    <strong>جميع الترمات -
                                                    <t t-esc="program.total_year_price"
                                                       t-options='{"widget": "monetary", "display_currency": program.currency_id}'/>
                                                    </strong>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <h3 class="mb-0">المستندات المطلوبة</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="required">نسخة من الهوية الإماراتية</label>
                                                    <input type="file" name="emirates_id_copy"
                                                           class="form-control"
                                                           accept="image/*,.pdf"
                                                           required="required"/>
                                                    <small class="text-muted">صيغ مقبولة: JPG, PNG, PDF</small>
                                                </div>

                                                <div class="col-md-6 mb-3">
                                                    <label>صورة الطالب</label>
                                                    <input type="file" name="student_photo"
                                                           class="form-control"
                                                           accept="image/*"/>
                                                    <small class="text-muted">اختياري - لأغراض التعريف</small>
                                                </div>
                                            </div>

                                            <div class="alert alert-info mt-3">
                                                <i class="fa fa-info-circle"/>
                                                ملاحظة: يُحتفظ بصور الطلاب في قاعدة البيانات لأغراض الصحة والسلامة.
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <h3 class="mb-0">معلومات إضافية</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label>حالات طبية خاصة</label>
                                                <textarea name="medical_conditions"
                                                          class="form-control"
                                                          rows="3"
                                                          placeholder="أي حالات طبية يجب أن نكون على علم بها..."><t t-esc="values.get('medical_conditions')"/></textarea>
                                            </div>

                                            <div class="mb-3">
                                                <label>الحساسية</label>
                                                <textarea name="allergies"
                                                          class="form-control"
                                                          rows="3"
                                                          placeholder="أي حساسية من الطعام أو الأدوية..."><t t-esc="values.get('allergies')"/></textarea>
                                            </div>

                                            <div class="mb-3">
                                                <label>ملاحظات</label>
                                                <textarea name="notes"
                                                          class="form-control"
                                                          rows="3"
                                                          placeholder="أي معلومات إضافية تود مشاركتها..."><t t-esc="values.get('notes')"/></textarea>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <div class="form-check mb-3">
                                                <input class="form-check-input" type="checkbox"
                                                       name="photo_permission" value="1"
                                                       id="photo_permission"
                                                       t-att-checked="values.get('photo_permission')"/>
                                                <label class="form-check-label" for="photo_permission">
                                                    أوافق على استخدام صور طفلي في أنشطة ومنشورات الجمعية
                                                </label>
                                            </div>

                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       name="terms_accepted" value="1"
                                                       id="terms_accepted"
                                                       required="required"/>
                                                <label class="form-check-label required" for="terms_accepted">
                                                    أوافق على الشروط والأحكام وأقر بصحة جميع المعلومات المقدمة
                                                </label>
                                                <t t-if="error.get('terms_accepted')">
                                                    <br/><span class="text-danger" t-esc="error['terms_accepted']"/>
                                                </t>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="text-center">
                                        <button type="submit" class="btn btn-success btn-lg">
                                            <i class="fa fa-check"/> إرسال طلب التسجيل
                                        </button>
                                        <a t-att-href="'/programs/%s' % slug(program)"
                                           class="btn btn-secondary btn-lg">
                                            <i class="fa fa-times"/> إلغاء
                                        </a>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>

    <!-- رسالة النجاح -->
    <template id="registration_success" name="نجاح التسجيل">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">
                <section class="s_success pt80 pb80">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8 offset-lg-2 text-center">
                                <div class="alert alert-success">
                                    <i class="fa fa-check-circle fa-4x mb-3 d-block"/>
                                    <h2>تم استلام طلب التسجيل بنجاح!</h2>
                                    <p class="lead">
                                        رقم التسجيل: <strong t-field="registration.registration_number"/>
                                    </p>
                                    <hr/>
                                    <p>
                                        تم تسجيل <strong t-field="registration.student_name"/>
                                        في برنامج <strong t-field="program.name"/>
                                    </p>
                                    <p>
                                        سيتم مراجعة طلبكم وإرسال تأكيد على البريد الإلكتروني المسجل.
                                    </p>
                                    <p class="mt-4">
                                        <a href="/clubs" class="btn btn-primary">
                                            <i class="fa fa-arrow-right"/> العودة للنوادي
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>

    <!-- البرنامج ممتلئ -->
    <template id="program_full" name="البرنامج ممتلئ">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure">
                <section class="s_full pt80 pb80">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8 offset-lg-2 text-center">
                                <div class="alert alert-warning">
                                    <i class="fa fa-exclamation-triangle fa-4x mb-3 d-block"/>
                                    <h2>عذراً، البرنامج ممتلئ!</h2>
                                    <p class="lead">
                                        برنامج <strong t-field="program.name"/> ممتلئ حالياً
                                    </p>
                                    <hr/>
                                    <p>
                                        يمكنك التواصل معنا لوضعك في قائمة الانتظار أو الاطلاع على البرامج الأخرى المتاحة.
                                    </p>
                                    <p class="mt-4">
                                        <a t-att-href="'/clubs/%s' % slug(program.club_id)" class="btn btn-primary">
                                            <i class="fa fa-arrow-right"/> عرض البرامج الأخرى
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>
</odoo>