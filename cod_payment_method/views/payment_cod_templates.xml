<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- COD specific inline form template -->
        <template id="cod_inline_form" name="COD Inline Form">
            <div>
                <input type="hidden" name="cod_payment" value="1"/>
                <!-- No additional fields needed for COD -->
            </div>
        </template>

        <!-- Add COD info to payment options list -->
        <template id="payment_option_cod_info" inherit_id="payment.payment_form">
            <xpath expr="//div[@name='o_payment_option_card']" position="inside">
                <t t-if="provider and provider.code == 'cod'">
                    <div class="cod-payment-info-inline text-muted small mt-2">
                        <i class="fa fa-truck"></i>
                        <span>Pay when you receive your order</span>
                    </div>
                </t>
            </xpath>
        </template>

        <!-- Override payment status page for COD -->
        <template id="payment_confirm_cod" inherit_id="payment.payment_confirm" priority="20">
            <xpath expr="//div[hasclass('oe_website_sale_tx_status')]" position="inside">
                <t t-if="tx and tx.provider_code == 'cod' and tx.state == 'pending'">
                    <div class="alert alert-success mt-3">
                        <h4 class="alert-heading">
                            <i class="fa fa-check-circle"></i> Order Placed Successfully!
                        </h4>
                        <p>Your order has been placed. You will pay <strong t-esc="tx.amount" t-options='{"widget": "monetary", "display_currency": tx.currency_id}'/> upon delivery.</p>
                        <hr/>
                        <p class="mb-0">Please have the exact amount ready when your order arrives.</p>
                    </div>
                </t>
            </xpath>
        </template>

        <!-- Add COD badge to sale order portal -->
        <template id="sale_order_portal_cod_badge" inherit_id="sale.sale_order_portal_template" priority="20">
            <xpath expr="//section[@id='details']//div[hasclass('row')]" position="inside">
                <t t-if="sale_order.transaction_ids.filtered(lambda t: t.provider_code == 'cod' and t.state != 'cancel')">
                    <div class="col-12 col-md-6 mb-2">
                        <strong>Payment Method:</strong>
                        <span class="badge badge-warning ml-2">
                            <i class="fa fa-money"></i> Cash on Delivery
                        </span>
                    </div>
                </t>
            </xpath>
        </template>
    </data>
</odoo>