<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- Portal User Access Rules -->

        <!-- Students can only see their own record -->
        <record id="hallway_student_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can only see their own record</field>
            <field name="model_id" ref="model_hallway_student"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can only see their enrollments -->
        <record id="hallway_enrollment_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can only see their enrollments</field>
            <field name="model_id" ref="model_hallway_enrollment"/>
            <field name="domain_force">[('student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can only see their payment lines -->
        <record id="hallway_payment_line_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can only see their payment lines</field>
            <field name="model_id" ref="model_hallway_payment_line"/>
            <field name="domain_force">[('student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can only see their attendance -->
        <record id="hallway_attendance_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can only see their attendance</field>
            <field name="model_id" ref="model_hallway_attendance"/>
            <field name="domain_force">[('student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can see course sessions for their enrolled courses -->
        <record id="hallway_course_session_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can see sessions for enrolled courses</field>
            <field name="model_id" ref="model_hallway_course_session"/>
            <field name="domain_force">[('course_id.enrollment_ids.student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can see courses they are enrolled in -->
        <record id="hallway_course_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can see courses they are enrolled in</field>
            <field name="model_id" ref="model_hallway_course"/>
            <field name="domain_force">[('enrollment_ids.student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Students can see all departments, subjects, and levels (read only) -->
        <record id="hallway_department_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can see all departments</field>
            <field name="model_id" ref="model_hallway_department"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="hallway_subject_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can see all subjects</field>
            <field name="model_id" ref="model_hallway_subject"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="hallway_subject_level_portal_rule" model="ir.rule">
            <field name="name">Portal: Students can see all subject levels</field>
            <field name="model_id" ref="model_hallway_subject_level"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>