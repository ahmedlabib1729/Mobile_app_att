<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- مجموعة معلمي القرآن -->
        <record id="group_quran_teacher" model="res.groups">
            <field name="name">معلم قرآن</field>
            <field name="category_id" ref="base.module_category_human_resources"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        <!-- مجموعة مدير المركز -->
        <record id="group_quran_manager" model="res.groups">
            <field name="name">مدير مركز القرآن</field>
            <field name="category_id" ref="base.module_category_human_resources"/>
            <field name="implied_ids" eval="[(4, ref('group_quran_teacher'))]"/>
        </record>

        <!-- قاعدة: المعلم يرى صفوفه فقط -->
        <record id="quran_class_teacher_rule" model="ir.rule">
            <field name="name">معلم القرآن: صفوفه فقط</field>
            <field name="model_id" ref="model_quran_class"/>
            <field name="domain_force">['|',
                ('teacher_id.user_id', '=', user.id),
                ('teacher_id2.user_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_quran_teacher'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- قاعدة: المعلم يرى جلساته فقط -->
        <record id="quran_session_teacher_rule" model="ir.rule">
            <field name="name">معلم القرآن: جلساته فقط</field>
            <field name="model_id" ref="model_quran_session"/>
            <field name="domain_force">['|',
                ('teacher_id.user_id', '=', user.id),
                ('teacher_id2.user_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_quran_teacher'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- قاعدة: المدير يرى كل شيء -->
        <record id="quran_class_manager_rule" model="ir.rule">
            <field name="name">مدير المركز: كل الصفوف</field>
            <field name="model_id" ref="model_quran_class"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_quran_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="quran_session_manager_rule" model="ir.rule">
            <field name="name">مدير المركز: كل الجلسات</field>
            <field name="model_id" ref="model_quran_session"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_quran_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- قاعدة: المعلم يرى طلاب صفوفه فقط -->
        <record id="quran_student_teacher_rule" model="ir.rule">
            <field name="name">معلم القرآن: طلاب صفوفه فقط</field>
            <field name="model_id" ref="model_quran_student"/>
            <field name="domain_force">['|',
                ('class_ids.teacher_id.user_id', '=', user.id),
                ('class_ids.teacher_id2.user_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_quran_teacher'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>